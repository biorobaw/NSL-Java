/* This file is generated by  NSL3.0 preprocessor*/

/* SCCS  %W% --- %G% -- %U% */

/*Motor
* Motor Generating Schema
* @see  Motor.nslm
* @version 98/6/18
* @author Dominey; coder Alexander
*/
 import nslj.src.system.*; 
 import nslj.src.cmd.*; 
 import nslj.src.lang.*; 
 import nslj.src.math.*; 
 import nslj.src.display.*; 

 public class Motor extends NslModule /*(int stdsz, int direction)*/  {
//private int direction; //l=1, r=2, u=3, d=4

// input ports
public NslDinFloat2 llbn ; /*(stdsz,stdsz)*/
public NslDinFloat2 supcol ; /*(stdsz,stdsz)*/
public NslDinFloat2 fefsac ; /*(stdsz,stdsz)*/
public NslDinFloat0 tn ; /* ()*/

//output ports
public NslDoutFloat0 ebn ; /* ()*/
public NslDoutFloat0 fefgate ; /*()*/
public NslDoutFloat0 mn ; /* ()*/
public NslDoutFloat0 tnDelta ; /*()*/

//vars
private MLBN mlbn1 ; /* (stdsz)*/
private EBN ebn1 ; /* (stdsz)*/
private Pause pause1 ; /* (stdsz)*/
private TNDelta tnDelta1 ; /*(stdsz)*/
private MN mn1 ; /*()*/
private STM stm1 ; /*(stdsz,direction)*/  //NSL2.1.7 had last in scheduler,
// but stm should be ok here since it comes after everything it feeds.

public  void initModule() {
	if (system.debug>=6) {
		System.out.println(("debug:Motor:initModule:direction ")+(direction));
	}

}
public  void initRun() {
	if (system.debug>=6) {
		System.out.println(("debug:Motor:initRun:direction ")+(direction));
	}
}
public  void makeConn() {
	// outputs to inputs
	// inputs	
	nslConnect(llbn,mlbn1.llbn);
	nslConnect(supcol,pause1.supcol);
	nslConnect(fefsac,pause1.fefsac);
	nslConnect(fefsac,tnDelta1.fefsac);
	nslConnect(tn,mn1.tn); 
	nslConnect(tn,tnDelta1.tn);

	//middles
	nslConnect(mlbn1.mlbn,ebn1.mlbn);
	nslConnect(mlbn1.mlbn,pause1.mlbn);
	nslConnect(ebn1.ebn,pause1.ebn);
	nslConnect(pause1.pause,ebn1.pause);

	nslConnect(ebn1.ebn,mn1.ebn); 

	nslConnect(stm1.stm,mlbn1.stm);	
	nslConnect(stm1.stm,pause1.stm);	
	nslConnect(stm1.weights,pause1.weights);
 
	// outputs
	nslConnect(ebn1.ebn,ebn);
	nslConnect(tnDelta1.fefgate,fefgate);
	nslConnect(mn1.mn,mn);
	nslConnect(tnDelta1.tnDelta,tnDelta);
}

public  void simRun(){
	if (system.debug>=6) {
		System.out.println(("debug:Motor:simRun:direction ")+(direction));
	}
}
	/* nslInitTempModule inserted by NPP */
public void nslInitTempModule() {
	/* Instantiation statements generated by NslPreProcessor */
	/* temporary variables */
	/* end of automatic instantiation statements */
	/* Intialisation statements generated by NslPreProcessor */
	/* temporary variables */
	/* end of automatic intialisation statements */
}

	/* nslInitTempRun inserted by NPP */
public void nslInitTempRun() {
	/* Intialisation statements generated by NslPreProcessor */
	/* temporary variables */
	/* end of automatic intialisation statements */
}

	/* nslInitTempTrain inserted by NPP */
public void nslInitTempTrain() {
	/* Initialisation statements generated by NslPreProcessor */
	/* temporary variables */
	/* end of automatic intialisation statements */
}

	/* Declaration statements generated by NslPreProcessor */
	/* makeinst() declared variables */
	/* temporary variables */
	/* constructor and related methods */
	/* nsl declarations */
	int stdsz;
	int direction;

	 /*GENERIC CONSTRUCTOR:   */
	 public Motor(String nslName, NslModule nslParent,int stdsz, int direction) {
		super(nslName, nslParent);
		this.stdsz = stdsz;
		this.direction = direction;
		initSys();
		makeInst(nslName, nslParent,stdsz, direction);
	}
	public void makeInst(String nslName, NslModule nslParent,int stdsz,int direction){ 
	 llbn=new NslDinFloat2 ("llbn",this,stdsz,stdsz); //NSLDECLS 
	 supcol=new NslDinFloat2 ("supcol",this,stdsz,stdsz); //NSLDECLS 
	 fefsac=new NslDinFloat2 ("fefsac",this,stdsz,stdsz); //NSLDECLS 
	 tn=new NslDinFloat0 ("tn",this); //NSLDECLS 
	 ebn=new NslDoutFloat0 ("ebn",this); //NSLDECLS 
	 fefgate=new NslDoutFloat0 ("fefgate",this); //NSLDECLS 
	 mn=new NslDoutFloat0 ("mn",this); //NSLDECLS 
	 tnDelta=new NslDoutFloat0 ("tnDelta",this); //NSLDECLS 
	 mlbn1=new MLBN ("mlbn1",this,stdsz); //NSLDECLS 
	 ebn1=new EBN ("ebn1",this,stdsz); //NSLDECLS 
	 pause1=new Pause ("pause1",this,stdsz); //NSLDECLS 
	 tnDelta1=new TNDelta ("tnDelta1",this,stdsz); //NSLDECLS 
	 mn1=new MN ("mn1",this); //NSLDECLS 
	 stm1=new STM ("stm1",this,stdsz,direction); //NSLDECLS 
	}
	/* end of automatic declaration statements */
}
